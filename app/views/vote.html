<div class="page-header">
  <h1>Hallintovaalit</h1>
</div>

<div
  class="jumbotron alert alert-danger"
  ng-if="vote.error">

  <div class="container">
    <h1>Kävi hassusti :/</h1>

    <p>
      Ehdokastietojen lataaminen epäonnistui.
    </p>

    <p>
      Pyydä <a ng-href="#/sign-up">uusi sisäänkirjautumislinkki</a>
      ja yritä uudelleen. Jos ongelma toistuu, ota yhteys ylioppilaskunnan
      vaalityöntekijään <a ng-href="mailto:vaalit@hyy.fi">vaalit@hyy.fi</a>.
    </p>

    <a
      ng-href="#/sign-up"
      class="btn btn-primary">
      Uusi sisäänkirjautumislinkki
    </a>
  </div>
</div>

<div class="row">
  <div class="col-xs-12">

    <form
      novalidate
      ng-hide="vote.error">

      <div>
        <div> <!-- required container for set-class-when-at-top -->

          <div
            class="panel panel-primary vote-ballot"
            set-class-when-at-top="fix-to-top"
            padding-when-at-top="10">
            <!-- N.B. padding-when-at-top must match the fixed position px,
                 otherwise a jumpy side-effect will occurr -->

            <div class="panel-heading">
              <h3 class="panel-title">Äänestä</h3>
            </div>

            <div class="panel-body">
              <span
                ng-hide="vote.isProspectSelected()">
                Valitse ehdokas listasta, sen jälkeen tähän ilmestyy äänestyslippu.
              </span>

              <vote-prospect
                ng-show="vote.isProspectSelected()"
                selected="vote.selected"
                all="vote.candidates">
              </vote-prospect>

            </div>


            <div class="panel-footer">
              <button
                class="btn btn-default"
                vote-confirm-click="Haluatko äänestää valitsemaasi henkilöä? Et voi muuttaa ääntäsi jälkikäteen."
                vote-confirm-action="vote.register()"
                ng-disabled="!vote.isProspectSelected() || vote.submitting || vote.submitted"
                >

                  <div ng-show="vote.submitting && !vote.submitted">
                    <span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span>
                    Äänestetään ..
                  </div>

                  <div ng-hide="vote.submitting || vote.submitted">
                    Äänestä
                  </div>

                  <div ng-show="vote.submitted">
                    Äänestetty!
                  </div>
              </button>

            </div>

          </div>

        </div>
      </div>

      <div
        class="alert alert-success"
        role="alert"
        ng-if="vote.submitted">
        <strong>Äänesi on nyt kirjattu!</strong> Voit sulkea selainikkunan.
      </div>

      <div ng-if="vote.loading">
        <span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span>
      </div>

      <div ng-if="!vote.loading">

        <h2>Hae ehdokasta</h2>
        <label>
          Numero
          <input ng-model="vote.candidate.number">
        </label>

        <label>
          Nimi
          <input ng-model="vote.candidate.name">
        </label>

        <div ng-repeat="a in vote.alliances">
          <h1
            ng-bind="a.name"
            ng-show="filteredCandidates.length">
          </h1>

          <ul>
            <li ng-repeat="c in filteredCandidates = (a.candidates | filter:vote.candidate)">
              <label>
                <input
                  type="radio"
                  ng-disabled="vote.submitting || vote.submitted"
                  ng-model="vote.selected"
                  ng-value="c.id">
                {{ c.id }}
                {{ c.number }}
                {{ c.name }}
              </label>
            </li>
          </ul>
        </div>

        <pre ng-bind="vote.alliances | candidate:vote.candidate | json"></pre>

      </div> <!-- /loading -->

    </form>

  </div> <!-- col -->
</div> <!-- row -->
