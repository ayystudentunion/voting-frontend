<h1>Hallintovaalit</h1>

<div ng-if="vote.error">
  <h1>Virhe ehdokastietojen lataamisessa</h1>

  <p>
    Ehdokastietojen lataaminen epäonnistui.
    <a href="#/sign-up">Pyydä uusi sisäänkirjautumislinkki</a>
    ja yritä uudelleen. Jos ongelma toistuu, ota yhteys ylioppilaskuntaan
    <a href="mailto:vaalit@hyy.fi">vaalit@hyy.fi</a>.
  </p>
</div>

<form
  novalidate
  ng-hide="vote.error">

  <h2>Äänestä</h2>

  <span
    ng-hide="vote.isProspectSelected()">
    Valitse ehdokas listasta, sen jälkeen tähän ilmestyy äänestyslippu.
  </span>

  <vote-prospect
    ng-show="vote.isProspectSelected()"
    selected="vote.selected"
    all="vote.candidates">
  </vote-prospect>

  <br>

  <button
    class="btn btn-default"
    vote-confirm-click="Haluatko äänestää valitsemaasi henkilöä? Et voi muuttaa ääntäsi jälkikäteen."
    vote-confirm-action="vote.register()"
    ng-disabled="vote.submitting || vote.submitted"
    ng-show="vote.isProspectSelected()">

      <div ng-show="vote.submitting && !vote.submitted">
        <span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span>
        Äänestetään ..
      </div>

      <div ng-hide="vote.submitting || vote.submitted">
        Äänestä
      </div>

      <div ng-show="vote.submitted">
        Äänestetty!
      </div>

    </button>

  <div ng-if="vote.loading">
    <span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span>
  </div>

  <div ng-if="!vote.loading">

    <h2>Hae ehdokasta</h2>
    <label>
      Numero
      <input ng-model="vote.candidate.number">
    </label>

    <label>
      Nimi
      <input ng-model="vote.candidate.name">
    </label>

    <div ng-repeat="a in vote.alliances">
      <h1
        ng-bind="a.name"
        ng-show="filteredCandidates.length">
      </h1>

      <ul>
        <li ng-repeat="c in filteredCandidates = (a.candidates | filter:vote.candidate)">
          <label>
            <input
              type="radio"
              ng-disabled="vote.submitting || vote.submitted"
              ng-model="vote.selected"
              ng-value="c.id">
            {{ c.id }}
            {{ c.number }}
            {{ c.name }}
          </label>
        </li>
      </ul>
    </div>

    <pre ng-bind="vote.alliances | candidate:vote.candidate | json"></pre>

  </div> <!-- /loading -->

</form>
